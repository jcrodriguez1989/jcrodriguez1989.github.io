<script>
// Navbar hamburger menu fix for Bootstrap 3 compatibility
// This ensures the mobile menu toggle works across all deployment environments

(function() {
  'use strict';
  
  // Ensure jQuery is available
  if (typeof jQuery === 'undefined') {
    console.warn('jQuery is required for navbar fix');
    return;
  }
  
  var $ = jQuery;
  
  $(document).ready(function() {
    // Get the navbar toggle button
    var toggleButton = $('.navbar-toggle');
    var navbar = $('#navbar');
    
    // Handle click on hamburger menu
    toggleButton.on('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      
      // Toggle the collapse state
      if (navbar.hasClass('collapse')) {
        navbar.removeClass('collapse');
        navbar.addClass('in');
        toggleButton.removeClass('collapsed');
        toggleButton.attr('aria-expanded', 'true');
      } else if (navbar.hasClass('in')) {
        navbar.removeClass('in');
        navbar.addClass('collapse');
        toggleButton.addClass('collapsed');
        toggleButton.attr('aria-expanded', 'false');
      } else {
        navbar.toggleClass('collapse in');
        toggleButton.toggleClass('collapsed');
        toggleButton.attr('aria-expanded', navbar.hasClass('in'));
      }
      
      return false;
    });
    
    // Close menu when clicking on a link
    navbar.find('a:not([data-toggle])').on('click', function() {
      if (navbar.hasClass('in')) {
        navbar.removeClass('in').addClass('collapse');
        toggleButton.addClass('collapsed');
        toggleButton.attr('aria-expanded', 'false');
      }
    });
    
    // Close menu when clicking outside
    $(document).on('click', function(e) {
      var clickedElement = $(e.target);
      var isClickInsideNavbar = clickedElement.closest('.navbar').length > 0;
      
      if (!isClickInsideNavbar && navbar.hasClass('in')) {
        navbar.removeClass('in').addClass('collapse');
        toggleButton.addClass('collapsed');
        toggleButton.attr('aria-expanded', 'false');
      }
    });
  });
})();
</script>
